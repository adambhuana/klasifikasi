<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Upload Dokumen PDF</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 min-h-screen flex items-center justify-center">

  <div class="bg-white shadow-xl rounded-2xl p-10 max-w-lg w-full">
    <h2 class="text-2xl font-bold mb-6 text-gray-800">Upload Dokumen PDF</h2>

    <!-- Dropzone Area -->
    <label for="fileInput">
      <div id="dropzone"
        class="border-2 border-dashed border-gray-400 rounded-xl p-10 text-center cursor-pointer transition hover:border-blue-500 hover:bg-blue-50">

        <svg class="w-12 h-12 mx-auto text-gray-400 mb-3" fill="none" stroke="currentColor"
          viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M7 16V4a1 1 0 011-1h8a1 1 0 011 1v12m4 0h-6m-4 0H3m5 0l4-4m0 0l4 4m-4-4v12"/>
        </svg>

        <p class="text-gray-600">
          <span class="font-semibold">Klik untuk upload</span> atau drag & drop file PDF.
        </p>
        <p class="text-xs text-gray-500 mt-2">Hanya file .pdf diterima</p>
      </div>
    </label>

    <input type="file" id="fileInput" accept="application/pdf" class="hidden">

    <!-- File name -->
    <p id="fileName" class="mt-4 text-gray-700 font-medium hidden"></p>

    <!-- Progress bar -->
    <div class="w-full bg-gray-200 rounded-full h-3 mt-4 hidden" id="progressContainer">
      <div id="progressBar" class="h-3 rounded-full bg-blue-500 transition-all duration-300"
        style="width: 0%"></div>
    </div>

    <!-- Upload Button -->
    <button id="uploadBtn"
      class="w-full mt-6 bg-blue-600 text-white py-3 rounded-xl text-lg font-semibold hover:bg-blue-700 transition disabled:bg-gray-400 disabled:cursor-not-allowed"
      disabled>
      Upload
    </button>

    <!-- Status Text -->
    <p id="statusMsg" class="mt-4 text-center text-gray-700 font-medium"></p>
  </div>

  <script>
    const fileInput = document.getElementById("fileInput");
    const dropzone = document.getElementById("dropzone");
    const fileName = document.getElementById("fileName");
    const uploadBtn = document.getElementById("uploadBtn");
    const progressContainer = document.getElementById("progressContainer");
    const progressBar = document.getElementById("progressBar");
    const statusMsg = document.getElementById("statusMsg");

    // Drag & Drop highlight
    dropzone.addEventListener("dragover", (e) => {
      e.preventDefault();
      dropzone.classList.add("border-blue-500", "bg-blue-50");
    });

    dropzone.addEventListener("dragleave", () => {
      dropzone.classList.remove("border-blue-500", "bg-blue-50");
    });

    dropzone.addEventListener("drop", (e) => {
      e.preventDefault();
      dropzone.classList.remove("border-blue-500", "bg-blue-50");

      const file = e.dataTransfer.files[0];
      handleFile(file);
    });

    dropzone.addEventListener("click", () => {
      fileInput.click();
    });

    fileInput.addEventListener("change", (e) => {
      handleFile(e.target.files[0]);
    });

    function handleFile(file) {
      if (!file) return;

      if (file.type !== "application/pdf") {
        alert("Hanya file PDF yang diperbolehkan.");
        return;
      }

      fileName.textContent = "üìÑ " + file.name;
      fileName.classList.remove("hidden");

      uploadBtn.disabled = false;
      uploadBtn.dataset.file = file;
    }

    uploadBtn.addEventListener("click", async () => {
      const file = fileInput.files[0];
      if (!file) return;

      uploadBtn.disabled = true;
      statusMsg.textContent = "Mengunggah...";
      statusMsg.classList.remove("text-green-600", "text-red-600");
      statusMsg.classList.add("text-gray-700");

      progressContainer.classList.remove("hidden");
      progressBar.style.width = "0%";

      const formData = new FormData();
      formData.append("data", file);

      try {
        const response = await fetch("https://n8n-w0kfee8uiagq.arman.sumopod.my.id/webhook/upload", {
          method: "POST",
          body: formData
        });

        // Simulate progress bar animation
        let progress = 0;
        const interval = setInterval(() => {
          progress = Math.min(progress + 10, 100);
          progressBar.style.width = progress + "%";

          if (progress >= 100) clearInterval(interval);
        }, 80);

        if (response.ok) {
          statusMsg.textContent = "‚úîÔ∏è Upload berhasil!";
          statusMsg.classList.replace("text-gray-700", "text-green-600");
        } else {
          statusMsg.textContent = "‚ùå Upload gagal.";
          statusMsg.classList.replace("text-gray-700", "text-red-600");
        }

      } catch (err) {
        statusMsg.textContent = "‚ö†Ô∏è Error: " + err;
        statusMsg.classList.replace("text-gray-700", "text-red-600");
      }
    });
  </script>

</body>
</html>

